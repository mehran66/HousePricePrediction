{
    "contents" : "---\ntitle: \"Lab 3: Mammal Sleep Patterns\"\nauthor: \"Merhan Ghandehari\"\ndate: \"February 6, 2016\"\noutput: html_document\n---\n\n\n\n ```{r, echo=FALSE}\n# sales = read.csv(\"Data/Milwaukee_Sales_2012.csv\")  # Load some data\n# cor.test(sales$SalePrice, sales$FinSqft)  # Correlation test\n# m = lm(SalePrice ~ FinSqft, data=sales)  # Fit a model\n# plot(SalePrice ~ FinSqft, data=sales)  # Scatterplot...\n# abline(m, col=\"red\")  # ...with best fit line\n```\n\n```{r, echo=FALSE}\nmammals = read.table(\"Data/SleepMammals.txt\", header=TRUE)\nsummary(mammals)\n\n# Converting the values for Predation, Exposure, and Danger from\n# n umeric (integers) to categorical data\nmammals$Predation = as.factor(mammals$Predation)\nmammals$Exposure = as.factor(mammals$Exposure)\nmammals$Danger = as.factor(mammals$Danger)\n# Show a summary of these newly converted variables \nsummary(mammals[, c(\"Predation\", \"Exposure\", \"Danger\")])\n```\n\n\t\nVariable\t\t  Description\nBodyWt\t\t    body weight (kg)\nBrainWt\t\t    brain weight (g)\nNonDreaming\t\tslow wave (\"nondreaming\") sleep (hrs/day)\nDreaming\t\t  paradoxical (\"dreaming\") sleep (hrs/day)\nTotalSleep\t\ttotal sleep, sum of slow wave and paradoxical sleep (hrs/day)\nLifeSpan\t\t  maximum life span (years)\nGestation\t\t  gestation time (days)\nPredation\t\t  predation index (1-5)\n              1 = minimum (least likely to be preyed upon); 5 = maximum (most likely               to be preyed upon)\nExposure\t  \tsleep exposure index (1-5)\n              1 = least exposed (e.g. animal sleeps in a well-protected den); 5 =                  most exposed\nDanger\t\t    overall danger index (1-5) (based on the above two indices and other                 information)\n              1 = least danger (from other animals); 5 = most danger (from other                   animals)\n\n```{r }\n# cerate a new variable in mammals dataframe named BrainPct (the percentage of total body weight that the brain weighs)\n# BrainPct = BrainWt / (BodyWt * 1000)\nmammals$BrainPct = (mammals$BrainWt / (mammals$BodyWt * 1000))*100\n\n#the highest BrainPct\nHighestBrainPct = mammals[mammals$BrainPct == max(mammals$BrainPct), \"Species\"]\nprint(HighestBrainPct)\n\n# HighestBrainPct = mammals[which.max(mammals$BrainPct), \"Species\"]\n\n\n# the lowest BrainPct\nLowestBrainPct = mammals[mammals$BrainPct == min(mammals$BrainPct), \"Species\"]\nprint(LowestBrainPct)\n\n# the mean of BrainPct\nMeanBrainPct = mean(mammals$BrainPct)\nprint(MeanBrainPct)\n\n# the median of BrainPct\nMedianBrainPct = median(mammals$BrainPct)\nprint(MedianBrainPct)\n```\n\n\n```{r, echo=FALSE, fig.align='center'}\n# distribution of BrainPct\npar(mfrow=c(2,2))\nhist(mammals$BrainPct, col=\"gray\", main = \"Histgram of brain percentage\", xlab = \"Brain percentage\")\nplot(density(mammals$BrainPct), col=\"gray\", main = \"Density plot of brain percentage\", xlab = \"Brain percentage\")\nboxplot(mammals$BrainPct, col=\"gray\", main = \"Boxplot of brain percentage\", ylab = \"Brain percentage\")\n\n# vioplot is a combination of a density plot and a box plot\nlibrary(vioplot)\nvioplot(mammals$BrainPct, col=\"gray\")\ntitle (main = \"Vioplot of brain percentage\", ylab = \"Brain percentage\")\n```\n\n- the distribution appears positively (right) skewed\n\n```{r }\nlibrary(moments)\nskewness(mammals$BrainPct)\n\nlibrary(e1071)\nskewness(mammals$BrainPct)\n```\n\nThe skewness here is 1.315525 or 1.283827. This value implies that the distribution of the data isskewed to the right or positively skewed.\n\n3. a scatterplot with LifeSpan on the y-axis and Gestation on the x-axis\n\n```{r }\nplot(mammals$Gestation, mammals$LifeSpan, \n     xlab = \"Gestation\",\n     ylab = \"LifeSpan\",\n     pch = 20,\n     col = \"grey\")\n```\n# get rid of all of the plots\n# dev.off(dev.list()[\"RStudioGD\"])\n\n4. a boxplot that compares body weight across the five Danger levels.\n\n```{r, echo=FALSE, fig.align='center'}\nboxplot(mammals$BodyWt ~ mammals$Danger,\n        col = \"beige\",\n        xlab = \"Danger Level = 1\",\n        ylab = \"Body Weight\", outline =F)\n\n\nmeans = aggregate(BodyWt~Danger,data=mammals,FUN=\"mean\", outline =F)\npar(new=T)\npoints(means, col=\"red\",pch=18)\n```\n\n4.2. a boxplot that compares TotalSleep across the five Danger levels\n\n```{r, echo=FALSE, fig.align='center'}\n\nboxplot(mammals$TotalSleep ~ mammals$Danger,\n        col = \"beige\",\n        xlab = \"Danger Level\",\n        ylab = \"Total Sleep\",\n        outline=FALSE)\n\nmeans = aggregate(TotalSleep~Danger,data=mammals,FUN=\"mean\", outline =F)\npar(new=T)\npoints(means, col=\"red\",pch=18)\n```\n- What inferences can you make about the sleeping conditions of an animal from this box plot?\n\n???what is danger index?\n\n# Data Transformations\n5-\n```{r }\nmammals$LogBrainPct = log(mammals$BrainPct)\nhist(mammals$LogBrainPct, freq=FALSE)\nmu = mean(mammals$LogBrainPct)\nstd = sd(mammals$LogBrainPct)\ncurve(dnorm(x, mean=mu, sd=std), add=TRUE)  # Add curve to plot\n```\n\n6-\nData transformation is used the data does not have a normal distribution.\n\n    There are many reasons for transformation. The list here is not\n    comprehensive\n        1. Convenience\n        2. Reducing skewness\n        3. Equal spreads\n        4. Linear relationships\n        5. Additive relationships\n        \nlinear tranformation is used to change data from one sclae to another (such as z score), but it does not change the shape of the distribution\nwith transformation you can chnage an exponentiol corelation to a linear corelation (y=m^x -> log y = x log m -> log y = ax + b) so if we log y and see that we have a straight line we can conclude that the original data has been exponential. if it was not an staright line, you should log both x and y, and then if the scatter plot was straght then the original data is power \n        \n# Correlation Analysis\n7) correlation between lifespan and gestation period\n```{r }\ncor(mammals$LifeSpan, mammals$Gestation, use = \"complete.obs\", method = \"pearson\")\n\ncor(mammals$LifeSpan, mammals$Gestation, use = \"complete.obs\", method =  \"kendall\")\n\ncor(mammals$LifeSpan, mammals$Gestation, use = \"complete.obs\", method = \"spearman\")\n```\n\nYes, from plot in question 3, it was clear that there is a positive linear relationship between these two variables.\n\n8-\n```{r }\nMammalsSubset = data.frame(TotalSleep = mammals$TotalSleep, BodyWt = mammals$BodyWt, BrainWt = mammals$BrainWt, LifeSpan = mammals$LifeSpan, Gestation = mammals$Gestation)\n\n# mammals[,sapply(mammals, is.numeric)] # this code is extract the numeric attributes, but here we don't need all of the numeric attributes\n\nMammalsSubset_corr = cor(MammalsSubset, use = \"complete.obs\", method = \"pearson\") # get correlations\n\nlibrary('corrplot') #package corrplot\ncorrplot(MammalsSubset_corr, method = \"circle\", addCoef.col = \"black\") #plot matrix\n\n# Use \"Pairs Plot\" from \"psych\" package to visualize scatter plot\nlibrary(\"psych\")\npairs.panels(MammalsSubset, gap = 0)\n```\nBased on Pearson’s correlation coefficient, which two variables are most and least correlated with each-other?\n\nBody weight and brain weight are the most correlated (0.93) and body weight and life span are the least correlated (0.30).\n\n#Part II\n## Linear Regression\n9-\n```{r }\n# what shoud I do with NA; there are many NA in mammals$TotalSleep\nSleep_BodyWt.lm = lm(mammals$TotalSleep ~ mammals$BodyWt)\ncoeffs = coefficients(Sleep_BodyWt.lm); coeffs\n\n#How to write the formula????\nβ0 = 10.835131637\nβ1 = -0.001524093\n\n# coefficient of determination of a linear regression model (the variances of the fitted values and observed values of the dependent variable)  \"Values of R2 close to 1 imply that most of the variability in y is explained by the regression model.\" \"0% indicates that the model explains none of the variability of the response data around its mean.\" \"Metric for evaluating the goodness of fit of your model. Higher is better with 1 being the best. \"\n\n\"*** for high significance and * for low significance\"\nsummary(Sleep_BodyWt.lm)$r.squared \n\nsummary(Sleep_BodyWt.lm)\n# P-value is higher than .05. so we accept the null hypothesis; it means that there is not a significant relationship between the variables in the linear regression model \"The p-value for each term tests the null hypothesis that the coefficient is equal to zero (no effect). A low p-value (< 0.05) indicates that you can reject the null hypothesis. In other words, a predictor that has a low p-value is likely to be a meaningful addition to your model because changes in the predictor's value are related to changes in the response variable. Conversely, a larger (insignificant) p-value suggests that changes in the predictor are not associated with changes in the response.\"\n\n\nplot(mammals$BodyWt, mammals$TotalSleep,\n     main = \"XXXX\",\n     xlab = \"XXX\",\n     ylab = \"YYY\",\n     pch = 20,\n     col = \"grey\")\n# Add fit lines\n# Linear regression line (y ~ x) \nabline(Sleep_BodyWt.lm, col=\"red\")\n\npar(mfrow=c(2,2))\nplot (Sleep_BodyWt.lm)\n\n# Residual Plot\nSleep_BodyWt.res = resid(Sleep_BodyWt.lm)\nplot(mammals$BodyWt[1:58], as.vector(Sleep_BodyWt.res), \n   ylab=\"Residuals\", \n   xlab=\"BodyWt\", \n   main=\"XXX\") \nabline(0, 0) # the horizon\n```\n10- similar to 9, just by replacing variables\n```{r }\nSleep_BodyWt.lm = lm(mammals$TotalSleep ~ mammals$BrainWt)\ncoeffs = coefficients(Sleep_BodyWt.lm); coeffs\nsummary(Sleep_BodyWt.lm)\n\nplot(mammals$BrainWt, mammals$TotalSleep,\n     main = \"XXXX\",\n     xlab = \"XXX\",\n     ylab = \"YYY\",\n     pch = 20,\n     col = \"grey\")\n# Add fit lines\n# Linear regression line (y ~ x) \nabline(Sleep_BodyWt.lm, col=\"red\")\n```\n##Multiple Regression\n```{r }\nMultiReg.lm = lm(mammals$TotalSleep ~ mammals$BodyWt + mammals$BrainWt + mammals$LifeSpan + mammals$Gestation)\n\nsummary(MultiReg.lm)\n```\n\n\n\n\n```{r }\n# what shoud I do with NA; there are many NA in mammals$TotalSleep\nSleep_BodyWt.lm = lm(mammals$TotalSleep ~ mammals$BodyWt)\ncoeffs = coefficients(Sleep_BodyWt.lm); coeffs\n\ntest = na.omit(data.frame(TotalSleep=mammals$TotalSleep, BodyWt=mammals$BodyWt))\ntest2 = test[test$TotalSleep > quantile(test$TotalSleep, .25) - 1.5*IQR(test$TotalSleep) & test$TotalSleep < quantile(test$TotalSleep, .75) + 1.5*IQR(test$TotalSleep) & test$BodyWt > quantile(test$BodyWt, .25) - 1.5*IQR(test$BodyWt) & test$BodyWt < quantile(test$BodyWt, .75) + 1.5*IQR(test$BodyWt),]\n\nSleep_BodyWt.lm = lm(test2$TotalSleep ~ test2$BodyWt)\nsummary(Sleep_BodyWt.lm)\n\nplot(test2$BodyWt, test2$TotalSleep,\n     main = \"XXXX\",\n     xlab = \"XXX\",\n     ylab = \"YYY\",\n     pch = 20,\n     col = \"grey\")\n# Add fit lines\n# Linear regression line (y ~ x) \nabline(Sleep_BodyWt.lm, col=\"red\")\n```\n",
    "created" : 1454809864646.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "716468640",
    "id" : "952892B4",
    "lastKnownWriteTime" : 1455417079,
    "path" : "~/Desktop/Quantitative/Lab3/Lab3_ghandehari.Rmd",
    "project_path" : "Lab3_ghandehari.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}