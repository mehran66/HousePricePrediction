{
    "contents" : "\n#install.packages(\"maptools\")\nlibrary(maptools)\n\nchicago <- readShapePoly(\"C:\\\\Users\\\\Emelie\\\\Documents\\\\Geog 5023 Quant\\\\ChicagoCrime.shp\")\n\n#see types of data in shape file\nslotNames(chicago)\n\n#plot information\nplot(chicago)\n\nchicago@data\n\nnames(chicago@data)\n\n#Read in a readable list of variable names\n#Seth created this by hand.  \n#Note the use of \":\" as a column delimiter\n#If names are too verbose for your liking edit them in the text file prior to importing\nvarNames <- \n  read.table(file = \"C:\\\\Users\\\\Emelie\\\\Documents\\\\Geog 5023 Quant\\\\Variable Descriptions.txt\", sep = \":\", strip.white = TRUE)\n\n#Attach the modified names to the chicago data\nnames(chicago@data) <- as.character(varNames[,2])\n\n\n#install.packages(\"classInt\")\nlibrary(classInt) #library for creating clases\n#Create Categories\ncats7 <- classIntervals(chicago$Number_of_violent_crimes, \n                        n = 7, style = \"quantile\") \n\n#install.packages(\"RColorBrewer\")\nlibrary(RColorBrewer)\n#display all palettes\ndisplay.brewer.all() \n\n#Lets use this one\ndisplay.brewer.pal(7, \"YlGnBu\")\n\n#save palette as an object\npal7 <- brewer.pal(7, \"YlGnBu\") \n\nSevenColors <- findColours(cats7, pal7) \n\n#draw map using specificed data and colors\n#lty=0 turns off tract borders.\nplot(chicago, col=SevenColors, lty = 0)\n\nseth.mdl <- lm(sqrt(Number_of_violent_crimes) ~ Population_Density + \n                 Percent_of_children_in_single_female_headed_household + \n                 Percent_of_households_with_no_car +  \n                 Percent_Less_than_High_School_Education_ + \n                 Percent_with_a_Graduate_Degree_ + \n                 Percent_Black_Alone +\n                 Median_House_Value +\n                 Median_Rent_ +\n                 Income_Gini_Coefficient_,\n               data=chicago@data)\n\nsummary(seth.mdl)\n\n#check residuals\nhist(resid(seth.mdl))\nplot(resid(seth.mdl) ~ predict(seth.mdl))\n\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(seth.mdl), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"YlOrRd\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#looks spatially random\n\n#remove variables to look at resulting spatial effects\nseth.mdl <- lm(sqrt(Number_of_violent_crimes) ~ Population_Density, data=chicago@data)\n\n#quantile categories of residuals\ncats5 <- classIntervals(resid(seth.mdl), \n                        n = 5, style =\"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"YlOrRd\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#more spatial clustering\n\n#check for multicolinearity\nseth.mdl <- lm(sqrt(Number_of_violent_crimes) ~ Population_Density + \n                 Percent_of_children_in_single_female_headed_household + \n                 Percent_of_households_with_no_car +  \n                 Percent_Less_than_High_School_Education_ + \n                 Percent_with_a_Graduate_Degree_ + \n                 Percent_Black_Alone +\n                 Median_House_Value +\n                 Median_Rent_ +\n                 Income_Gini_Coefficient_,\n               data=chicago@data)\n\nlibrary(car)\nvif(seth.mdl)\n\n#remove variables which indicate multicolinearity:\nseth.mdl.reduced <- lm(sqrt(Number_of_violent_crimes) ~ Population_Density + \n                         Percent_of_households_with_no_car +  \n                         Percent_with_a_Graduate_Degree_ + \n                         Percent_Black_Alone +\n                         Median_House_Value +\n                         Median_Rent_ +\n                         Income_Gini_Coefficient_,\n                       data=chicago@data)\n\nvif(seth.mdl.reduced) #do you notice an improvement in VIFs?\nanova(seth.mdl, seth.mdl.reduced) #Compare the full and reduced forms of the model\n\n\nlibrary(lmSupport)\nmodelEffectSizes(seth.mdl.reduced)\n\n######################################################################################\n##MODEL 1\n#Number of violent crimes\n\nnames(chicago@data)\n\n##Map of dependent variable\n#install.packages(\"classInt\")\nlibrary(classInt) #library for creating clases\n#Create Categories\ncats7 <- classIntervals(sqrt(chicago$Number_of_violent_crimes), \n                        n = 7, style = \"quantile\") \n\n#install.packages(\"RColorBrewer\")\nlibrary(RColorBrewer)\n#display all palettes\ndisplay.brewer.all() \n\n#Lets use this one\ndisplay.brewer.pal(7, \"YlGnBu\")\n\n#save palette as an object\npal7 <- brewer.pal(7, \"YlGnBu\") \n\nSevenColors <- findColours(cats7, pal7) \n\nplot(chicago, col=SevenColors, lty = 0)\n\nplot(chicago@data$Number_of_violent_crimes)\nshapiro.test(chicago@data$Number_of_violent_crimes)\n#W = 0.8671, p-value < 2.2e-16\n\nplot(sqrt(chicago@data$Number_of_violent_crimes))\nshapiro.test(sqrt(chicago@data$Number_of_violent_crimes))\n#W = 0.9814, p-value = 1.934e-07\n#better\nlog\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Median_Rent_,  data=chicago@data)\n        \nsummary(lm1)\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-5.7366 -1.8874 -0.2693  1.7119  7.3464 \n\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)   6.7502468  0.4157489  16.236  < 2e-16 ***\n#  Median_Rent_ -0.0013624  0.0004402  -3.095  0.00205 ** \n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#\n#Residual standard error: 2.529 on 654 degrees of freedom\n#(4 observations deleted due to missingness)\n#Multiple R-squared:  0.01443,  Adjusted R-squared:  0.01293 \n#F-statistic: 9.579 on 1 and 654 DF,  p-value: 0.002053\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Median_Rent_ + \n          Percent_Black_Alone ,  data=chicago@data)\n\nsummary(lm1)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-7.4692 -1.2823 -0.0567  1.3050  7.6699 \n#\n#Coefficients:\n#                       Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)          3.883e+00  3.487e-01  11.135   <2e-16 ***\n#  Median_Rent_        -7.407e-05  3.454e-04  -0.214     0.83    \n#Percent_Black_Alone  3.821e-02  1.814e-03  21.063   <2e-16 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#\n#Residual standard error: 1.953 on 653 degrees of freedom\n#(4 observations deleted due to missingness)\n#Multiple R-squared:  0.4131,  Adjusted R-squared:  0.4113 \n#F-statistic: 229.9 on 2 and 653 DF,  p-value: < 2.2e-16\n\n#R2 MUCH better, residuals closer to 0, rent doesn't seem to matter much.\n\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone ,  data=chicago@data)\n\nsummary(lm1)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-7.4910 -1.2849 -0.0699  1.3179  7.6399 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)         3.800251   0.108758   34.94   <2e-16 ***\n#  Percent_Black_Alone 0.038406   0.001776   21.62   <2e-16 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#\n#Residual standard error: 1.948 on 658 degrees of freedom\n#Multiple R-squared:  0.4153,  Adjusted R-squared:  0.4144 \n#F-statistic: 467.4 on 1 and 658 DF,  p-value: < 2.2e-16\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone + \n        Income_Gini_Coefficient_,  data=chicago@data)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-7.4837 -1.2879 -0.0689  1.3167  7.6265 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)              3.672686   0.482085   7.618    9e-14 ***\n#  Percent_Black_Alone      0.038237   0.001883  20.309   <2e-16 ***\n# Income_Gini_Coefficient_ 0.307891   1.133520   0.272    0.786    \n#---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#\n#Residual standard error: 1.949 on 657 degrees of freedom\n#Multiple R-squared:  0.4154,  Adjusted R-squared:  0.4136 \n#F-statistic: 233.4 on 2 and 657 DF,  p-value: < 2.2e-16\n\nsummary(lm1)\n\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone\n          + Percent_Employed_in_Service_Occupations \n          + Income_Gini_Coefficient_,  data=chicago@data)\n\nsummary(lm1)\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-7.3451 -1.2476 -0.0313  1.2166  8.0577 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                             2.713957   0.533105   5.091 4.66e-07 ***\n#  Percent_Black_Alone                     0.035312   0.001999  17.665  < 2e-16 ***\n#  Percent_Employed_in_Service_Occupations 0.034660   0.008633   4.015 6.63e-05 ***\n#  Income_Gini_Coefficient_                0.960214   1.132415   0.848    0.397    \n#---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#\n#Residual standard error: 1.927 on 656 degrees of freedom\n#Multiple R-squared:  0.4294,  Adjusted R-squared:  0.4268 \n#F-statistic: 164.6 on 3 and 656 DF,  p-value: < 2.2e-16\n\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone\n        + Percent_Employed_in_Service_Occupations \n        + Income_Gini_Coefficient_ \n        +Population_Density,  data=chicago@data)\n\nsummary(lm1)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-6.7727 -1.2653 -0.0387  1.0865  8.4962 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                             2.131e+00  5.278e-01   4.038 6.02e-05 ***\n#  Percent_Black_Alone                     3.917e-02  2.047e-03  19.138  < 2e-16 ***\n#  Percent_Employed_in_Service_Occupations 2.861e-02  8.463e-03   3.381 0.000766 ***\n#  Income_Gini_Coefficient_                2.819e-01  1.108e+00   0.254 0.799243    \n#  Population_Density                      5.586e-05  9.172e-06   6.090 1.92e-09 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#\n#Residual standard error: 1.876 on 655 degrees of freedom\n#Multiple R-squared:   0.46,  Adjusted R-squared:  0.4567 \n#F-statistic: 139.5 on 4 and 655 DF,  p-value: < 2.2e-16\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone\n        + Percent_Employed_in_Service_Occupations \n        + Income_Gini_Coefficient_ \n        +Population_Density\n        +PCT_of_Households_with_cash_public_assistance,  data=chicago@data)\n\nsummary(lm1)\nhist(resid(lm1))\nplot(resid(lm1) ~ predict(lm1))\n#residuals look good\n\n#Residuals:\n#  Min     1Q Median     3Q    Max \n#-7.294 -1.172  0.006  1.107  8.668 \n#\n#Coefficients:\n#                                               Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                    2.728e+00  5.232e-01   5.213 2.49e-07 ***\n#  Percent_Black_Alone                            3.049e-02  2.453e-03  12.431  < 2e-16 ***\n#  Percent_Employed_in_Service_Occupations        6.100e-03  9.036e-03   0.675    0.500    \n#Income_Gini_Coefficient_                      -9.392e-01  1.098e+00  -0.856    0.392    \n#Population_Density                             4.799e-05  9.024e-06   5.318 1.44e-07 ***\n#  PCT_of_Households_with_cash_public_assistance  4.353e-02  7.169e-03   6.071 2.15e-09 ***\n\n#Residual standard error: 1.827 on 654 degrees of freedom\n#Multiple R-squared:  0.4888,  Adjusted R-squared:  0.4849 \n#F-statistic: 125.1 on 5 and 654 DF,  p-value: < 2.2e-16\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone\n        + Percent_Employed_in_Service_Occupations \n        + Income_Gini_Coefficient_ \n        +Population_Density\n        +PCT_of_Households_with_cash_public_assistance\n        +Neighborhood_typology_by_Spielman_and_Singleton,  data=chicago@data)\n\nsummary(lm1)\nhist(resid(lm1))\nplot(resid(lm1) ~ predict(lm1))\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-6.9795 -0.9975  0.0000  0.8630  5.5871 \n\n#Residual standard error: 1.682 on 585 degrees of freedom\n#Multiple R-squared:  0.6123,  Adjusted R-squared:  0.5633 \n#F-statistic: 12.48 on 74 and 585 DF,  p-value: < 2.2e-16\n\n\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone\n        + Percent_Employed_in_Service_Occupations \n        + Income_Gini_Coefficient_ \n        +Population_Density\n        +PCT_of_Households_with_cash_public_assistance\n        +Neighborhood_typology_by_Spielman_and_Singleton \n        +Percent_of_children_in_single_female_headed_household,  data=chicago@data)\n\nsummary(lm1)\nhist(resid(lm1))\nplot(resid(lm1) ~ predict(lm1))\n#Heteroskedastic\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-6.8790 -1.0038  0.0000  0.8719  5.4295 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                            1.994e+00  1.031e+00   1.934 0.053620 .  \n#Percent_Black_Alone                                    2.396e-02  7.242e-03   3.308 0.000996 ***\n#  Percent_Employed_in_Service_Occupations                2.407e-02  9.820e-03   2.451 0.014548 *  \n#  Income_Gini_Coefficient_                               8.594e-01  1.324e+00   0.649 0.516377    \n#Population_Density                                     2.049e-05  1.046e-05   1.960 0.050498 .  \n#Neighborhood_typology_by_Spielman_and_Singleton\n#\n#Residual standard error: 1.68 on 584 degrees of freedom\n#Multiple R-squared:  0.614,  Adjusted R-squared:  0.5644 \n#F-statistic: 12.39 on 75 and 584 DF,  p-value: < 2.2e-16\n\n#remove neighborhood typology variable due to heteroskedasticity\nlm1<-lm(sqrt(Number_of_violent_crimes)~ Percent_Black_Alone\n        + Percent_Employed_in_Service_Occupations \n        + Income_Gini_Coefficient_ \n        +Population_Density\n        +PCT_of_Households_with_cash_public_assistance \n        +Percent_of_children_in_single_female_headed_household,  data=chicago@data)\n\nsummary(lm1)\nhist(resid(lm1))\nplot(resid(lm1) ~ predict(lm1))\n#Residuals look good\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm1), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"YlOrRd\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look spatially random\n\nlibrary(car)\nvif(lm1)\n\n#Percent_Black_Alone \n#3.630764 \n#Percent_Employed_in_Service_Occupations \n#1.412228 \n#Income_Gini_Coefficient_ \n#1.207640 \n#Population_Density \n#1.135403 \n#PCT_of_Households_with_cash_public_assistance \n#2.618304 \n#Percent_of_children_in_single_female_headed_household \n#3.751107\n####Drop Percent black alone or percent of children in single \n####female headed household due to multicollinearity\n\nlm1reduced<-lm(sqrt(Number_of_violent_crimes)~ Percent_Employed_in_Service_Occupations \n        + Income_Gini_Coefficient_ \n        +Population_Density\n        +PCT_of_Households_with_cash_public_assistance \n        +Percent_of_children_in_single_female_headed_household,  data=chicago@data)\n\nsummary(lm1reduced)\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-6.9093 -1.2462 -0.1003  1.1417  7.8415 \n\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                            2.400e+00  5.539e-01   4.332 1.71e-05 ***\n#  Percent_Employed_in_Service_Occupations                4.992e-03  9.607e-03   0.520   0.6035    \n#Income_Gini_Coefficient_                              -1.675e-01  1.165e+00  -0.144   0.8858    \n#Population_Density                                     2.259e-05  9.151e-06   2.469   0.0138 *  \n#  PCT_of_Households_with_cash_public_assistance          5.719e-02  7.810e-03   7.323 7.14e-13 ***\n#  Percent_of_children_in_single_female_headed_household  3.328e-02  4.151e-03   8.019 4.94e-15 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.938 on 654 degrees of freedom\n#Multiple R-squared:  0.4246,  Adjusted R-squared:  0.4202 \n#F-statistic: 96.52 on 5 and 654 DF,  p-value: < 2.2e-16\nhist(resid(lm1reduced), xlab = \"Residuals\", \n     ylab = \"Frequency\", main = \"Residuals Histogram\")\n#looks better\nplot(resid(lm1reduced) ~ predict(lm1reduced), xlab = \"Predicted\", \n     ylab = \"Residuals\", main = \"Residuals Plot\")\n#Residuals look ok\n\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm1reduced), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"YlOrRd\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look spatially random\n\nlibrary(car)\nvif(lm1reduced)\n#Percent_Employed_in_Service_Occupations \n#1.412142 \n#Income_Gini_Coefficient_ \n#1.198907 \n#Population_Density \n#1.031721 \n#PCT_of_Households_with_cash_public_assistance \n#2.484143 \n#Percent_of_children_in_single_female_headed_household \n#2.238812 \n\nanova(lm1, lm1reduced)\n#Res.Df    RSS Df Sum of Sq      F    Pr(>F)    \n#1    653 2180.1                                  \n#2    654 2456.3 -1   -276.26 82.749 < 2.2e-16 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#Full model explains significantly more variance\n\nlibrary(lmSupport)\nmodelEffectSizes(lm1reduced)\n#                                                            SSR df pEta-sqr dR-sqr\n#(Intercept)                                            70.4930  1   0.0279     NA\n#Percent_Employed_in_Service_Occupations                 1.0141  1   0.0004 0.0002\n#Income_Gini_Coefficient_                                0.0776  1   0.0000 0.0000\n#Population_Density                                     22.8915  1   0.0092 0.0054\n#PCT_of_Households_with_cash_public_assistance         201.4299  1   0.0758 0.0472\n#Percent_of_children_in_single_female_headed_household 241.4946  1   0.0895 0.0566\n\n#Sum of squared errors (SSE): 2456.4\n#Sum of squared total  (SST): 4268.9\n\n########################################################################################\n\n\n########################################################################################\n\n##Model 2\n##Vehicle Theft\n\n#install.packages(\"classInt\")\nlibrary(classInt) #library for creating clases\n#Create Categories\ncats7 <- classIntervals(chicago@data$Vehicle_Theft, \n                        n = 7, style = \"quantile\") \n\n#install.packages(\"RColorBrewer\")\nlibrary(RColorBrewer)\n#display all palettes\ndisplay.brewer.all() \n\n#Lets use this one\ndisplay.brewer.pal(7, \"Purples\")\n\n#save palette as an object\npal7 <- brewer.pal(7, \"Purples\") \n\nSevenColors <- findColours(cats7, pal7) \n\nplot(chicago, col=SevenColors, lty = 0)\n\n#Test Normality\nplot(chicago@data$Vehicle_Theft)\n\nshapiro.test(chicago@data$Vehicle_Theft)\n#data:  chicago@data$Vehicle_Theft\n#W = 0.9216, p-value < 2.2e-16\n\nplot(sqrt(chicago@data$Vehicle_Theft))\nshapiro.test(sqrt(chicago@data$Vehicle_Theft))\n#data:  sqrt(chicago@data$Vehicle_Theft)\n#W = 0.9935, p-value = 0.005998\n\nnames(chicago@data)\n\nlm2<-NULL\n\nlm2<-lm(sqrt(Vehicle_Theft)~ Weapons_Violation, data=chicago@data)\n        \nsummary(lm2)\n\n#Residual standard error: 1.42 on 658 degrees of freedom\n#Multiple R-squared:  0.1787,  Adjusted R-squared:  0.1775 \n#F-statistic: 143.2 on 1 and 658 DF,  p-value: < 2.2e-16\n\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +PCT_of_Households_with_cash_public_assistance, data=chicago@data)\n\nsummary(lm2)\n\n#Residual standard error: 1.419 on 657 degrees of freedom\n#Multiple R-squared:  0.1812,  Adjusted R-squared:  0.1787 \n#F-statistic:  72.7 on 2 and 657 DF,  p-value: < 2.2e-16\n\n##Remove pct Housholds with public assistance\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_, data=chicago@data)\n\nsummary(lm2)\n#Residual standard error: 1.364 on 657 degrees of freedom\n#Multiple R-squared:  0.2428,  Adjusted R-squared:  0.2404 \n#F-statistic: 105.3 on 2 and 657 DF,  p-value: < 2.2e-16\n\n\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Burglary, data=chicago@data)\n\nsummary(lm2)\n\n#Residual standard error: 1.25 on 656 degrees of freedom\n#Multiple R-squared:  0.3653,  Adjusted R-squared:  0.3624 \n#F-statistic: 125.9 on 3 and 656 DF,  p-value: < 2.2e-16\n\nnames(chicago@data)\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Burglary\n        +Liquor_License, data=chicago@data)\n\nsummary(lm2)\n\n#Residual standard error: 1.239 on 655 degrees of freedom\n#Multiple R-squared:  0.377,  Adjusted R-squared:  0.3732 \n#F-statistic: 99.07 on 4 and 655 DF,  p-value: < 2.2e-16\n\nnames(chicago@data)\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Burglary\n        +Liquor_License\n        +Gambling, data=chicago@data)\n\nsummary(lm2)\n\n#Residual standard error: 1.236 on 654 degrees of freedom\n#Multiple R-squared:  0.3814,  Adjusted R-squared:  0.3766 \n#F-statistic: 80.63 on 5 and 654 DF,  p-value: < 2.2e-16\n\nnames(chicago@data)\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Burglary\n        +Liquor_License\n        +Vandalism\n        +Gambling, data=chicago@data)\n\nsummary(lm2)\n\n#                   Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)        2.186287   0.098586  22.176  < 2e-16 ***\n#  Weapons_Violation -0.014170   0.011513  -1.231  0.21884    \n#Percent_Hispanic_  0.010431   0.001575   6.625 7.29e-11 ***\n#  Burglary           0.010475   0.003461   3.027  0.00257 ** \n#  Liquor_License     0.066333   0.040945   1.620  0.10570    \n#Vandalism          0.033037   0.003059  10.800  < 2e-16 ***\n#  Gambling           0.021325   0.018710   1.140  0.25481    \n#---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.139 on 653 degrees of freedom\n#Multiple R-squared:  0.4751,  Adjusted R-squared:  0.4703 \n#F-statistic: 98.51 on 6 and 653 DF,  p-value: < 2.2e-16\n\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Burglary\n        +Liquor_License\n        +Vandalism\n        +Gambling\n        +Percent_of_families_that_consist_of_married_couples, data=chicago@data)\n\nsummary(lm2)\n\n#Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                          2.551004   0.147760  17.264  < 2e-16 ***\n#  Weapons_Violation                                   -0.020318   0.011578  -1.755  0.07976 .  \n#Percent_Hispanic_                                    0.013212   0.001776   7.438 3.23e-13 ***\n#  Burglary                                             0.011298   0.003444   3.281  0.00109 ** \n#  Liquor_License                                       0.064083   0.040645   1.577  0.11536    \n#Vandalism                                            0.031986   0.003053  10.478  < 2e-16 ***\n#  Gambling                                             0.019062   0.018583   1.026  0.30539    \n#Percent_of_families_that_consist_of_married_couples -0.011488   0.003487  -3.294  0.00104 ** \n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.131 on 652 degrees of freedom\n#Multiple R-squared:  0.4837,  Adjusted R-squared:  0.4782 \n#F-statistic: 87.26 on 7 and 652 DF,  p-value: < 2.2e-16\n\n\n#Remove Gambling\nlm2<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Burglary\n        +Liquor_License\n        +Vandalism\n        +Percent_of_families_that_consist_of_married_couples, data=chicago@data)\n\nsummary(lm2)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-3.6562 -0.7577  0.0283  0.8075  4.0158 \n\n#Coefficients:\n#                                                      Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                          2.555369   0.147705  17.301  < 2e-16 ***\n#  Weapons_Violation                                   -0.016560   0.010984  -1.508 0.132121    \n#Percent_Hispanic_                                    0.012990   0.001763   7.368 5.26e-13 ***\n#  Burglary                                             0.010891   0.003421   3.184 0.001524 ** \n#  Liquor_License                                       0.067283   0.040527   1.660 0.097354 .  \n#Vandalism                                            0.032315   0.003036  10.644  < 2e-16 ***\n#  Percent_of_families_that_consist_of_married_couples -0.011620   0.003485  -3.334 0.000904 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.131 on 653 degrees of freedom\n#Multiple R-squared:  0.4829,  Adjusted R-squared:  0.4781 \n#F-statistic: 101.6 on 6 and 653 DF,  p-value: < 2.2e-16\n\nhist(resid(lm2))\nplot(resid(lm2) ~ predict(lm2))\n#Residuals look OK\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm2), \n                        n = 5, style = \"jenks\")\ndisplay.brewer.all() \n\n#five class color palette\npal5 <- brewer.pal(5, \"RdPu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look spatially random\n\nlibrary(car)\nvif(lm2)\n\n#Weapons_Violation \n#2.471509 \n#Percent_Hispanic_ \n#1.564896 \n#Burglary \n#2.628906 \n#Liquor_License \n#1.139642 \n#Vandalism \n#3.662257 \n#Percent_of_families_that_consist_of_married_couples \n#1.620016 \n\n#Vandalism and Burglary likely have multicollinearity. I will drop Burglary\n\nlm2reduced<-lm(sqrt(chicago@data$Vehicle_Theft)~ Weapons_Violation \n        +Percent_Hispanic_\n        +Vandalism\n        +Liquor_License\n        +Percent_of_families_that_consist_of_married_couples, data=chicago@data)\n\nsummary(lm2reduced)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-3.6061 -0.7645  0.0229  0.8021  3.9655 \n\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                          2.555233   0.148733  17.180  < 2e-16 ***\n#  Weapons_Violation                                   -0.012595   0.010989  -1.146  0.25217    \n#Percent_Hispanic_                                    0.012666   0.001772   7.146 2.39e-12 ***\n#  Vandalism                                            0.038208   0.002423  15.767  < 2e-16 ***\n#  Liquor_License                                       0.060130   0.040746   1.476  0.14050    \n#Percent_of_families_that_consist_of_married_couples -0.010761   0.003499  -3.076  0.00219 ** \n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.139 on 654 degrees of freedom\n#Multiple R-squared:  0.4748,  Adjusted R-squared:  0.4708 \n#F-statistic: 118.3 on 5 and 654 DF,  p-value: < 2.2e-16\n\nhist(resid(lm2reduced))\nplot(resid(lm2reduced) ~ predict(lm2reduced))\n#Residuals look OK\n\nhist(resid(lm2reduced), xlab = \"Residuals\", \n     ylab = \"Frequency\", main = \"Residuals Histogram\")\n#looks better\nplot(resid(lm2reduced) ~ predict(lm2reduced), xlab = \"Predicted\", \n     ylab = \"Residuals\", main = \"Residuals Plot\")\n#Residuals look ok\n\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm2reduced), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"RdPu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look mostly spatially random\n\nlibrary(car)\nvif(lm2reduced)\n#Weapons_Violation \n#2.439722 \n#Percent_Hispanic_ \n#1.559678 \n#Vandalism \n#2.301129 \n#Liquor_License \n#1.136139 \n#Percent_of_families_that_consist_of_married_couples \n#1.610298 \n#much better\n\nanova(lm2, lm2reduced)\n#  Res.Df    RSS Df Sum of Sq      F   Pr(>F)   \n#1    653 835.06                                \n#2    654 848.02 -1    -12.96 10.135 0.001524 **\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#Full model explains significantly more variance\n\nlibrary(lmSupport)\nmodelEffectSizes(lm2reduced)\n#                                                            SSR df pEta-sqr dR-sqr\n#Coefficients\n#SSR df pEta-sqr dR-sqr\n#(Intercept)                                         382.7138  1   0.3110     NA\n#Weapons_Violation                                     1.7032  1   0.0020 0.0011\n#Percent_Hispanic_                                    66.2162  1   0.0724 0.0410\n#Vandalism                                           322.3303  1   0.2754 0.1996\n#Liquor_License                                        2.8238  1   0.0033 0.0017\n#Percent_of_families_that_consist_of_married_couples  12.2649  1   0.0143 0.0076\n\n#Sum of squared errors (SSE): 848.0\n#Sum of squared total  (SST): 1614.8\n\n########################################################################################\n\n\n\n########################################################################################\n##Model 3\n##Burglary\n\n##Plot dependent variable\ncats7 <- classIntervals(chicago@data$Burglary, \n                        n = 7, style = \"quantile\") \n\n#install.packages(\"RColorBrewer\")\n#display all palettes\ndisplay.brewer.all() \n\n#Lets use this one\ndisplay.brewer.pal(7, \"GnBu\")\n\n#save palette as an object\npal7 <- brewer.pal(7, \"GnBu\") \n\nSevenColors <- findColours(cats7, pal7) \n\nplot(chicago, col=SevenColors, lty = 0)\n\n#Test Normality\nplot(chicago@data$Burglary)\n\nshapiro.test(chicago@data$Burglary)\n#data:  chicago@data$Burglary\n#W = 0.8565, p-value < 2.2e-16\n\nplot(sqrt(chicago@data$Burglary))\nshapiro.test(sqrt(chicago@data$Burglary))\n#data:  sqrt(chicago@data$Burglary)\n#W = 0.9819, p-value = 2.683e-07\n\nnames(chicago@data)\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.3616,  Adjusted R-squared:  0.3606 \n#F-statistic: 372.7 on 1 and 658 DF,  p-value: < 2.2e-16\n\nnames(chicago@data)\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Median_Rent_, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.3646,  Adjusted R-squared:  0.3627 \n#F-statistic: 187.4 on 2 and 653 DF,  p-value: < 2.2e-16\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Median_Rent_\n        +Percent_Black_Alone, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.3685,  Adjusted R-squared:  0.3656 \n#F-statistic: 126.8 on 3 and 652 DF,  p-value: < 2.2e-16\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Median_Rent_\n        +Percent_Black_Alone\n        +Percent_Less_than_High_School_Education_, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.3727,  Adjusted R-squared:  0.3689 \n#F-statistic:  96.7 on 4 and 651 DF,  p-value: < 2.2e-16\n\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Median_Rent_\n        +Percent_Black_Alone\n        +Percent_Less_than_High_School_Education_\n        +Percent_of_families_that_consist_of_married_couples\n        +Population_Density, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.3971,  Adjusted R-squared:  0.3915 \n#F-statistic: 71.25 on 6 and 649 DF,  p-value: < 2.2e-16\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Median_Rent_\n        +Percent_Black_Alone\n        +Percent_Less_than_High_School_Education_\n        +Percent_of_families_that_consist_of_married_couples\n        +Population_Density\n        +Number_of_violent_crimes, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.5082,  Adjusted R-squared:  0.5029 \n#F-statistic: 95.65 on 7 and 648 DF,  p-value: < 2.2e-16\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Median_Rent_\n        +Percent_Black_Alone\n        +Percent_Less_than_High_School_Education_\n        +Percent_of_families_that_consist_of_married_couples\n        +Population_Density\n        +Number_of_violent_crimes\n        +Number_of_property_crimes, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.5297,  Adjusted R-squared:  0.5239 \n#F-statistic: 91.09 on 8 and 647 DF,  p-value: < 2.2e-16\n\n#Remove Percent Black Alone, Percent of Families Married, Median Rent\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Percent_Less_than_High_School_Education_\n        +Population_Density\n        +Number_of_violent_crimes\n        +Number_of_property_crimes, data=chicago@data)\n\nsummary(lm3)\n\n#Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                               2.942e+00  1.443e-01  20.394  < 2e-16 ***\n#  Weapons_Violation                         7.873e-02  1.533e-02   5.135 3.73e-07 ***\n#  Percent_Less_than_High_School_Education_ -2.978e-02  6.193e-03  -4.808 1.89e-06 ***\n#  Population_Density                        3.400e-05  6.216e-06   5.470 6.41e-08 ***\n#  Number_of_violent_crimes                  2.508e-02  3.617e-03   6.933 9.90e-12 ***\n#  Number_of_property_crimes                 3.232e-03  5.702e-04   5.668 2.17e-08 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.317 on 654 degrees of freedom\n#Multiple R-squared:  0.5291,  Adjusted R-squared:  0.5255 \n#F-statistic:   147 on 5 and 654 DF,  p-value: < 2.2e-16\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Percent_Less_than_High_School_Education_\n        +Population_Density\n        +Number_of_violent_crimes\n        +Number_of_property_crimes\n        +Vandalism, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.6403,  Adjusted R-squared:  0.637 \n#F-statistic: 193.7 on 6 and 653 DF,  p-value: < 2.2e-16\n\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Percent_Less_than_High_School_Education_\n        +Population_Density\n        +Number_of_violent_crimes\n        +Number_of_property_crimes\n        +Vandalism\n        +Liquor_License, data=chicago@data)\n\nsummary(lm3)\n\n#Multiple R-squared:  0.644,  Adjusted R-squared:  0.6401 \n#F-statistic: 168.5 on 7 and 652 DF,  p-value: < 2.2e-16\n\n#Remove violent crimes\nlm3<-lm(sqrt(Burglary)~ Weapons_Violation\n        +Percent_Less_than_High_School_Education_\n        +Population_Density\n        +Number_of_property_crimes\n        +Vandalism\n        +Liquor_License, data=chicago@data)\n\nsummary(lm3)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-3.9038 -0.7546 -0.0023  0.6010  3.8369 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                               2.173e+00  1.327e-01  16.383  < 2e-16 ***\n#  Weapons_Violation                         3.752e-02  1.110e-02   3.379 0.000770 ***\n#  Percent_Less_than_High_School_Education_ -1.816e-02  5.197e-03  -3.494 0.000508 ***\n#  Population_Density                        3.386e-05  5.542e-06   6.110 1.71e-09 ***\n#  Number_of_property_crimes                 1.576e-03  4.829e-04   3.264 0.001154 ** \n#  Vandalism                                 4.636e-02  2.804e-03  16.532  < 2e-16 ***\n#  Liquor_License                           -1.065e-01  4.088e-02  -2.606 0.009377 ** \n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1#\n#\n#Residual standard error: 1.146 on 653 degrees of freedom\n#Multiple R-squared:  0.644,  Adjusted R-squared:  0.6407 \n#F-statistic: 196.8 on 6 and 653 DF,  p-value: < 2.2e-16\n\nhist(resid(lm3))\nplot(resid(lm3) ~ predict(lm3))\n#Residuals look OK\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm3), \n                        n = 5, style = \"jenks\")\n#five class color palette\npal5 <- brewer.pal(5, \"GnBu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look kind of random\n\nlibrary(car)\nvif(lm3)\n\n#Weapons_Violation Percent_Less_than_High_School_Education_ \n#2.460332                                 1.176421 \n#Population_Density                Number_of_property_crimes \n#1.083007                                 1.585466 \n#Vandalism                           Liquor_License \n#3.044851                                 1.129915 \n\n#Vandalism and Weapons Violation likely have multicollinearity. I will drop Weapons Violation\n\nlm3reduced<-lm(sqrt(Burglary)~ Percent_Less_than_High_School_Education_\n          +Population_Density\n          +Number_of_property_crimes\n          +Vandalism\n          +Liquor_License, data=chicago@data)\n\nsummary(lm3)\nsummary(lm3reduced)\n\n#Residuals:\n#  Min      1Q  Median      3Q     Max \n#-3.8261 -0.7675 -0.0120  0.6410  3.7216 \n#\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                               2.089e+00  1.313e-01  15.908  < 2e-16 ***\n#  Percent_Less_than_High_School_Education_ -1.354e-02  5.054e-03  -2.679  0.00757 ** \n#  Population_Density                        3.230e-05  5.567e-06   5.803 1.02e-08 ***\n#  Number_of_property_crimes                 1.333e-03  4.813e-04   2.770  0.00576 ** \n#  Vandalism                                 5.287e-02  2.056e-03  25.716  < 2e-16 ***\n#  Liquor_License                           -1.143e-01  4.114e-02  -2.779  0.00561 ** \n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 1.155 on 654 degrees of freedom\n#Multiple R-squared:  0.6377,  Adjusted R-squared:  0.635 \n#F-statistic: 230.3 on 5 and 654 DF,  p-value: < 2.2e-16\n\nhist(resid(lm3reduced))\nplot(resid(lm3reduced) ~ predict(lm3reduced))\n#Residuals look OK\n\nhist(resid(lm3reduced), xlab = \"Residuals\", \n     ylab = \"Frequency\", main = \"Residuals Histogram\")\n#looks better\nplot(resid(lm3reduced) ~ predict(lm3reduced), xlab = \"Predicted\", \n     ylab = \"Residuals\", main = \"Residuals Plot\")\n#Residuals look ok\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm3reduced), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"RdPu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look mostly spatially random\n\nlibrary(car)\nvif(lm3reduced)\n#Percent_Less_than_High_School_Education_                       Population_Density \n#1.095072                                 1.075479 \n#Number_of_property_crimes                                Vandalism \n#1.550265                                 1.610447 \n#Liquor_License \n#1.126312 \n##This looks good\n\nanova(lm3, lm3reduced)\n#  Res.Df    RSS Df Sum of Sq      F   Pr(>F)   \n#1    653 857.04                                  \n#2    654 872.02 -1   -14.987 11.419 0.0007703 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#Full model explains significantly more variance\n\nlibrary(lmSupport)\nmodelEffectSizes(lm3reduced)\n#                                              SSR df pEta-sqr dR-sqr\n#(Intercept)                              337.4199  1   0.2790     NA\n#Percent_Less_than_High_School_Education_   9.5712  1   0.0109 0.0040\n#Population_Density                        44.8990  1   0.0490 0.0187\n#Number_of_property_crimes                 10.2320  1   0.0116 0.0043\n#Vandalism                                881.8032  1   0.5028 0.3663\n#Liquor_License                            10.2972  1   0.0117 0.0043\n\n#Sum of squared errors (SSE): 872.0\n#Sum of squared total  (SST): 2407.1\n\n#######################################################################################\n\n\n#######################################################################################\n##Model 4\n##Median Rent\n#Test Normality\nplot(chicago@data$Median_Rent_)\n\nshapiro.test(chicago@data$Median_Rent_)\n#W = 0.8962, p-value < 2.2e-16\n#Not normal\n\nplot(sqrt(chicago@data$Median_Rent_))\nshapiro.test(sqrt(chicago@data$Median_Rent_))\n#data:  sqrt(chicago@data$Burglary)\n#W = 0.9268, p-value < 2.2e-16\n\nnames(chicago@data)\n\nlm4<-lm(sqrt(chicago@data$Median_Rent_)~ Percent_Black_Alone\n        +Number_of_violent_crimes\n        +Number_of_property_crimes\n        +Homicides\n        +Sexual_Assault\n        +Agg._Assault\n        +Percent_of_children_in_single_female_headed_household\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Percent_Employed_in_Service_Occupations\n        +Population_Density\n        +Vandalism\n        +Disorderly_Conduct, data=chicago@data)\n\nsummary(lm4)\n#Multiple R-squared:  0.2677,  Adjusted R-squared:  0.2528 \n#F-statistic: 18.05 on 13 and 642 DF,  p-value: < 2.2e-16\n\n#Remove Vandalism, violent crimes, Density\nlm4<-lm(sqrt(chicago@data$Median_Rent_)~Number_of_property_crimes\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Percent_Employed_in_Service_Occupations, data=chicago@data)\n\nsummary(lm4)\n\n#Remove Vandalism, violent crimes, Density\nlm4<-lm(sqrt(chicago@data$Median_Rent_)~Number_of_property_crimes\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Percent_Employed_in_Service_Occupations\n        +Percent_non-citizen_, data=chicago@data)\n\nsummary(lm4)\n\n#########################################################################\n##Model 5\n##Weapons Violation\n\n##Plot dependent variable\ncats7 <- classIntervals(chicago@data$Weapons_Violation, \n                        n = 7, style = \"quantile\") \n\n#install.packages(\"RColorBrewer\")\n#display all palettes\ndisplay.brewer.all() \n\n#save palette as an object\npal7 <- brewer.pal(7, \"BuPu\") \n\nSevenColors <- findColours(cats7, pal7) \n\nplot(chicago, col=SevenColors, lty = 0)\n#Weapons violations are clustered\n\n#Test Normality\nplot(chicago@data$Weapons_Violation)\n\nshapiro.test(chicago@data$Weapons_Violation)\n#W = 0.7881, p-value < 2.2e-16\n#non-normal\n\nplot(sqrt(chicago@data$Weapons_Violation))\nshapiro.test(sqrt(chicago@data$Weapons_Violation))\n#W = 0.9484, p-value = 2.105e-14\n#Normal enough\n\nnames(chicago@data)\n\nlm4<-lm(sqrt(chicago@data$Weapons_Violation)~ Percent_Black_Alone\n        +Number_of_violent_crimes\n        +Number_of_property_crimes\n        +Homicides\n        +Sexual_Assault\n        +Agg._Assault\n        +Percent_of_children_in_single_female_headed_household\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Percent_Employed_in_Service_Occupations\n        +Population_Density\n        +Vandalism\n        +Disorderly_Conduct, data=chicago@data)\n\nsummary(lm4)\n\n#Multiple R-squared:  0.7663,  Adjusted R-squared:  0.7616 \n#F-statistic:   163 on 13 and 646 DF,  p-value: < 2.2e-16\n\n\n#Remove largest non-significant P-values\nlm4<-lm(sqrt(chicago@data$Weapons_Violation)~ Percent_Black_Alone\n        +Number_of_violent_crimes\n        +Number_of_property_crimes\n        +Homicides\n        +Agg._Assault\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Vandalism\n        +Disorderly_Conduct, data=chicago@data)\n\nsummary(lm4)\n\n#Multiple R-squared:  0.7656,  Adjusted R-squared:  0.7623 \n#F-statistic: 235.9 on 9 and 650 DF,  p-value: < 2.2e-16\n\n#Remove property crimes and homicide\nlm4<-lm(sqrt(chicago@data$Weapons_Violation)~ Percent_Black_Alone\n        +Number_of_violent_crimes\n        +Agg._Assault\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Vandalism\n        +Disorderly_Conduct, data=chicago@data)\n\nsummary(lm4)\n\n#Residuals:\n#  Min       1Q   Median       3Q      Max \n#-2.11854 -0.43045  0.03485  0.45633  2.30748 \n\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                   -0.143545   0.076239  -1.883 0.060169 .  \n#Percent_Black_Alone                            0.013243   0.001369   9.671  < 2e-16 ***\n#  Number_of_violent_crimes                       0.008816   0.002335   3.775 0.000175 ***\n#  Agg._Assault                                   0.023928   0.010097   2.370 0.018085 *  \n#  Percent_Hispanic_                              0.008074   0.001348   5.990 3.47e-09 ***\n#  PCT_of_Households_with_cash_public_assistance  0.004588   0.002764   1.659 0.097500 .  \n#Vandalism                                      0.009220   0.001873   4.923 1.08e-06 ***\n#  Disorderly_Conduct                             0.041419   0.006166   6.717 4.04e-11 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 0.6652 on 652 degrees of freedom\n#Multiple R-squared:  0.7633,  Adjusted R-squared:  0.7608 \n#F-statistic: 300.4 on 7 and 652 DF,  p-value: < 2.2e-16\n\nhist(resid(lm4))\nplot(resid(lm4) ~ predict(lm4))\n#Residuals look strange (in lines) likely has to do with the data recording\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm4), \n                        n = 5, style = \"jenks\")\n#five class color palette\npal5 <- brewer.pal(5, \"BuPu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look random\n\nlibrary(car)\nvif(lm4)\n\n#Percent_Black_Alone                      Number_of_violent_crimes \n#5.094282                                      8.132724 \n#Agg._Assault                             Percent_Hispanic_ \n#4.952765                                      2.642775 \n#PCT_of_Households_with_cash_public_assistanc      Vandalism \n#2.641898                                      4.027620 \n#Disorderly_Conduct \n#2.123076 \n\n##Yikes! Really high VIFs/multicollinearity. Going to try removing Percent Black alone, \n##agg assault and vandalism.\n\n\nlm4reduced<-lm(sqrt(chicago@data$Weapons_Violation)~Number_of_violent_crimes\n        +Percent_Hispanic_\n        +PCT_of_Households_with_cash_public_assistance\n        +Disorderly_Conduct, data=chicago@data)\n\n\nsummary(lm4)\nsummary(lm4reduced)\n\n#Residuals:\n#  Min       1Q   Median       3Q      Max \n#-2.52663 -0.53672  0.05691  0.51145  2.40570 \n\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                    0.3324113  0.0651575   5.102 4.42e-07 ***\n#  Number_of_violent_crimes                       0.0241407  0.0014304  16.876  < 2e-16 ***\n#  Percent_Hispanic_                             -0.0002316  0.0009854  -0.235    0.814    \n#PCT_of_Households_with_cash_public_assistance  0.0201615  0.0022665   8.896  < 2e-16 ***\n#  Disorderly_Conduct                             0.0389829  0.0067050   5.814 9.53e-09 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 0.7272 on 655 degrees of freedom\n#Multiple R-squared:  0.7159,  Adjusted R-squared:  0.7141 \n#F-statistic: 412.6 on 4 and 655 DF,  p-value: < 2.2e-16\n\nhist(resid(lm4reduced))\nplot(resid(lm4reduced) ~ predict(lm4reduced))\n#Residuals look off\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm4reduced), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"RdPu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look mostly spatially random\n\nlibrary(car)\nvif(lm4reduced)\n#Number_of_violent_crimes                    Percent_Hispanic_ \n#2.553563                                      1.182019 \n#PCT_of_Households_with_cash_public_assistance       Disorderly_Conduct \n#1.486105                                       2.100901 \n#Try once more\n\nlm4reduced2<-lm(sqrt(chicago@data$Weapons_Violation)~Percent_Hispanic_\n               +PCT_of_Households_with_cash_public_assistance\n               +Disorderly_Conduct, data=chicago@data)\n\n\nsummary(lm4)\nsummary(lm4reduced2)\n\n#Residuals:\n#Min      1Q  Median      3Q     Max \n#-2.9835 -0.6945  0.0355  0.5162  2.7496 \n\n#Coefficients:\n#  Estimate Std. Error t value Pr(>|t|)    \n#(Intercept)                                    0.709552   0.073259   9.686   <2e-16 ***\n#  Percent_Hispanic_                             -0.005759   0.001112  -5.177    3e-07 ***\n#  PCT_of_Households_with_cash_public_assistance  0.032656   0.002564  12.737   <2e-16 ***\n#  Disorderly_Conduct                             0.110159   0.006239  17.656   <2e-16 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n#Residual standard error: 0.8704 on 656 degrees of freedom\n#Multiple R-squared:  0.5923,  Adjusted R-squared:  0.5905 \n#F-statistic: 317.7 on 3 and 656 DF,  p-value: < 2.2e-16\n\npar(mfrow = c(1, 2))\nhist(resid(lm4reduced2), xlab = \"Residuals\", \n     ylab = \"Frequency\", main = \"Residuals Histogram\")\n#looks better\nplot(resid(lm4reduced2) ~ predict(lm4reduced2), xlab = \"Predicted\", \n     ylab = \"Residuals\", main = \"Residuals Plot\")\n#Residuals look ok\ndev.off()\n\n#jenks categories of residuals\ncats5 <- classIntervals(resid(lm4reduced2), \n                        n = 5, style = \"jenks\")\n\n#five class color palette\npal5 <- brewer.pal(5, \"RdPu\") \n\n#attach colors to categories\nfiveColors <- findColours(cats5, pal5)\n\n#plot map\nplot(chicago, col=fiveColors, lty = 0)\n#Residuals look mostly spatially random\n\nlibrary(car)\nvif(lm4reduced2)\n#Percent_Hispanic_ PCT_of_Households_with_cash_public_assistance \n#1.051442                                      1.327523 \n#Disorderly_Conduct \n#1.269692 \n\nanova(lm4, lm4reduced2)\n#  Res.Df    RSS Df Sum of Sq      F   Pr(>F)   \n#1    652 288.51                                  \n#2    656 496.94 -4   -208.43 117.76 < 2.2e-16 ***\n#  ---\n#  Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#Full model explains significantly more variance\n\nlibrary(lmSupport)\nmodelEffectSizes(lm4reduced2)\n#                                                   SSR df pEta-sqr dR-sqr\n#(Intercept)                                    71.0645  1   0.1251     NA\n#Percent_Hispanic_                              20.3033  1   0.0393 0.0167\n#PCT_of_Households_with_cash_public_assistance 122.8878  1   0.1983 0.1008\n#Disorderly_Conduct                            236.1620  1   0.3221 0.1937\n\n#Sum of squared errors (SSE): 496.9\n#Sum of squared total  (SST): 1218.9\n",
    "created" : 1456542789461.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1709550212",
    "id" : "12AB809A",
    "lastKnownWriteTime" : 1456848861,
    "path" : "~/Desktop/Class_Materisals/Seth/Emilie/Geog 5023 Quant/Lab 4 Bailey.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}